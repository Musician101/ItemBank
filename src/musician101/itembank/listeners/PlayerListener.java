package musician101.itembank.listeners;

import java.io.File;

import musician101.itembank.ItemBank;
import musician101.itembank.lib.Messages;
import musician101.itembank.util.IBUtils;

import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerJoinEvent;

/**
 * Handles player events and executes the necessary code based off the event.
 * 
 * @author Musician101
 */
public class PlayerListener implements Listener
{
	/** The template used when a player's account is created or reset. */
	public static String template = "# Do not edit this file unless it's absolutely necessary.\n";
	
	ItemBank plugin;
	
	/**
	 * @param plugin References the plugin's main class.
	 */
	public PlayerListener(ItemBank plugin)
	{
		this.plugin = plugin;
	}
	
	/**
	 * Code that is executed when a player joins the server.
	 * 
	 * @param event All of the information stored in the event.
	 */
	@EventHandler
	public void onPlayerLogin(PlayerJoinEvent event)
	{
		Player player = event.getPlayer();
		plugin.playerFile = new File(plugin.playerDataDir + "/" + player.getName().toLowerCase() + ".yml");
		IBUtils.createPlayerFile(plugin, plugin.playerFile);
		if (!plugin.playerFile.exists())
			player.sendMessage(Messages.PREFIX + "Error: The plugin failed to create your account. Please aleart an admin.");
	}
}
